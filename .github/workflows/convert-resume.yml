name: Convert DOCX to HTML and Commit

on:
  push:
    paths:
      - 'resume.docx' # Trigger when resume.docx is pushed or updated

jobs:
  convert-and-commit:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4 # Use v4 for the latest actions/checkout

      - name: Install Pandoc
        run: |
          sudo apt-get update
          sudo apt-get install -y pandoc

      - name: Convert DOCX to HTML
        run: |
          pandoc -s resume.docx -o index.html

      - name: Add Interactive Elements (Optional - if you have custom CSS/JS)
        # This step assumes custom.css and custom.js are in the root directory
        run: |
          if [ -f "custom.css" ]; then
            sed -i '/<\/head>/i\    <link rel="stylesheet" href="custom.css">' index.html
          fi
          if [ -f "custom.js" ]; then
            sed -i '/<\/body>/i\    <script src="custom.js"></script>' index.html
          fi

      - name: Configure Git
        run: |
          git config user.name "GitHub Actions Bot"
          git config user.email "github-actions[bot]@users.noreply.github.com"

      - name: Commit and Push index.html
        run: |
          git add index.html
          # Check if there are changes to commit
          if git diff --staged --quiet; then
            echo "No changes to index.html to commit."
          else
            git commit -m "Auto-generate index.html from resume.docx"
            git push
          fi
